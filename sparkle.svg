<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" width="100%" height="100%">
  <defs>
    <filter id="textbookShadowBlur" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur in="SourceGraphic" stdDeviation="12" />
    </filter>
    <style>
      svg { background: radial-gradient(circle at center, #ffffff 0%, #ffeaf1 100%); width: 100vw; height: 100vh; margin: 0; padding: 0; overflow: hidden; cursor: pointer; }
      
      /* Phase 1: Presentation (0s - 1s) - Drop in */
      .sparkler-wrapper { transform-origin: 100px 105px; opacity: 0; transform: translate(20px, -150px) rotate(45deg); }
      svg:hover .sparkler-wrapper { animation: presentSparkler 5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }
      @keyframes presentSparkler {
        0%, 15% { transform: translate(20px, -150px) rotate(45deg); opacity: 0; }
        25%, 100% { transform: translate(0px, 0px) rotate(0deg); opacity: 1; }
      }

      /* Phase 2: Warm Up (1s - 2s) - Base Glow */
      .warmup-glow { transform-origin: 100px 45px; opacity: 0; }
      svg:hover .warmup-glow { animation: warmup 5s forwards; }
      @keyframes warmup { 
        20%, 30% { opacity: 0; transform: scale(0.5); } 
        35%, 100% { opacity: 0.8; transform: scale(1.5); }
      }

      /* Phase 3: Ignition (2s - 2.5s) - Intense Core */
      .fire-core { transform-origin: 100px 45px; opacity: 0; }
      svg:hover .fire-core { animation: ignite 5s forwards; }
      @keyframes ignite {
        35%, 40% { opacity: 0; transform: scale(0); }
        45%, 100% { opacity: 1; transform: scale(1); }
      }

      /* Phase 4: Spark Show (3s - 4.5s) - Particle Eruption */
      .spark { transform-origin: 100px 45px; opacity: 0; }
      svg:hover .spark { animation: shootSpark 0.4s 4 ease-out forwards; }
      .spark:nth-child(1) { --tx: -45px; --ty: -35px; animation-delay: 2.0s; }
      .spark:nth-child(2) { --tx: 40px; --ty: -40px; animation-delay: 2.1s; }
      .spark:nth-child(3) { --tx: -35px; --ty: 45px; animation-delay: 2.3s; }
      .spark:nth-child(4) { --tx: 45px; --ty: 25px; animation-delay: 2.2s; }
      .spark:nth-child(5) { --tx: 0px; --ty: -55px; animation-delay: 2.05s; }
      .spark:nth-child(6) { --tx: -50px; --ty: 10px; animation-delay: 2.25s; }
      .spark:nth-child(7) { --tx: 35px; --ty: 50px; animation-delay: 2.15s; }
      .spark:nth-child(8) { --tx: 50px; --ty: -10px; animation-delay: 2.35s; }
      .spark:nth-child(9) { --tx: -20px; --ty: -50px; animation-delay: 2.4s; }
      .spark:nth-child(10) { --tx: 20px; --ty: -60px; animation-delay: 2.1s; }
      @keyframes shootSpark {
        0% { transform: translate(0, 0) scale(1.5); opacity: 1; filter: brightness(2); }
        80% { opacity: 1; filter: brightness(1); }
        100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; }
      }

      /* Phase 5: Pulse Core (Overlaps 3-4.5s) */
      svg:hover .pulse { animation: pulseCore 0.3s infinite alternate forwards; animation-delay: 2.0s; }
      @keyframes pulseCore { 0% { transform: scale(0.8); opacity: 0.9; } 100% { transform: scale(1.3); opacity: 1; } }

      /* Floor Shadow Drop (Matches Phase 1) */
      .sparkler-shadow { transform-origin: center; opacity: 0; }
      svg:hover .sparkler-shadow { animation: shadowDrop 5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }
      @keyframes shadowDrop { 10%, 100% { opacity: 0.3; transform: scale(1); } }
      
      /* Magical Background Sparkles */
      .bg-sparkle { opacity: 0; transform-origin: center; }
      svg:hover .bgs-1 { animation: bgTwinkle 5s forwards; transform-origin: 30px 40px; }
      svg:hover .bgs-2 { animation: bgTwinkle 5s forwards; transform-origin: 160px 50px; animation-delay: 0.3s; }
      svg:hover .bgs-3 { animation: bgTwinkle 5s forwards; transform-origin: 40px 140px; animation-delay: 0.6s; }
      svg:hover .bgs-4 { animation: bgTwinkle 5s forwards; transform-origin: 170px 140px; animation-delay: 0.9s; }
      @keyframes bgTwinkle { 0% { opacity: 0; transform: scale(0) rotate(0deg); } 20%, 80% { opacity: 1; transform: scale(1.5) rotate(45deg); filter: url(#glow); } 100% { opacity: 0; transform: scale(0) rotate(90deg); } }
      
      /* Base Dessert Plating (Static for Context) */
      .plate-shadow { transform-origin: 100px 165px; opacity: 0.2; }
    </style>
    
    <linearGradient id="plate" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#fdfbfb"/>
      <stop offset="100%" stop-color="#ebedee"/>
    </linearGradient>
    <linearGradient id="baseTier" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#00f2fe"/>
      <stop offset="100%" stop-color="#4facfe"/>
    </linearGradient>
    <linearGradient id="topTier" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#ff0844"/>
      <stop offset="100%" stop-color="#ffb199"/>
    </linearGradient>
    <linearGradient id="chocolateDrip" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#8e2de2"/>
      <stop offset="100%" stop-color="#4a00e0"/>
    </linearGradient>
    <linearGradient id="stickCoating" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#f6d365"/>
      <stop offset="50%" stop-color="#ffb142"/>
      <stop offset="100%" stop-color="#d35400"/>
    </linearGradient>
    
    <path id="star" d="M 0 -8 C 2 -2, 4 -1, 8 0 C 4 1, 2 2, 0 8 C -2 2, -4 1, -8 0 C -4 -1, -2 -2, 0 -8 Z" fill="#ff9f43" />
    
    <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="2.5" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  </defs>

  <g class="scene">
    <!-- Animated Playful Background Sparkles -->
    <use href="#star" class="bg-sparkle bgs-1" />
    <use href="#star" class="bg-sparkle bgs-2" />
    <use href="#star" class="bg-sparkle bgs-3" />
    <use href="#star" class="bg-sparkle bgs-4" />

    <ellipse cx="100" cy="170" rx="80" ry="25" fill="#a4b0be" class="plate-shadow" filter="url(#textbookShadowBlur)" />
    
    <!-- Static Base Cake -->
    <path d="M 40 135 L 40 155 A 60 22 0 0 0 160 155 L 160 135 Z" fill="url(#baseTier)" />
    <ellipse cx="100" cy="135" rx="60" ry="22" fill="#74b9ff" />
    <path d="M 55 105 L 55 135 A 45 18 0 0 0 145 135 L 145 105 Z" fill="url(#topTier)" />
    <path d="M 55 105 L 55 115 C 60 125, 65 110, 70 120 C 75 130, 85 110, 95 125 C 105 140, 115 115, 125 125 C 130 130, 140 115, 145 115 L 145 105 Z" fill="url(#chocolateDrip)" />
    <ellipse cx="100" cy="105" rx="45" ry="18" fill="#a29bfe" />
    <g stroke-width="3" stroke-linecap="round">
      <line x1="75" y1="105" x2="80" y2="102" stroke="#ffeaa7" />
      <line x1="120" y1="110" x2="125" y2="113" stroke="#55efc4" />
      <line x1="105" y1="95" x2="112" y2="95" stroke="#ff7675" />
      <line x1="85" y1="112" x2="90" y2="115" stroke="#fab1a0" />
      <line x1="125" y1="100" x2="130" y2="98" stroke="#ffeaa7" />
    </g>

    <!-- Sparkler Sequence -->
    <ellipse cx="100" cy="107" rx="15" ry="5" fill="#2d3436" class="sparkler-shadow" filter="url(#textbookShadowBlur)" />
    <g class="sparkler-wrapper">
      <ellipse cx="100" cy="107" rx="5" ry="2" fill="rgba(0,0,0,0.6)" />
      <line x1="100" y1="108" x2="100" y2="35" stroke="#f1c40f" stroke-width="3" stroke-linecap="round" />
      <line x1="100" y1="85" x2="100" y2="40" stroke="url(#stickCoating)" stroke-width="7" stroke-linecap="round" />
      
      <!-- Fire Core -->
      <circle cx="100" cy="45" r="18" fill="#ff4757" filter="url(#glow)" class="warmup-glow" />
      <g class="fire-core pulse">
        <circle cx="100" cy="45" r="9" fill="#ffa502" filter="url(#glow)" opacity="0.9" />
        <circle cx="100" cy="45" r="4" fill="#ffffff" />
      </g>
      
      <!-- Erupting Sparks -->
      <g stroke-width="3" stroke-linecap="round">
        <line x1="100" y1="45" x2="108" y2="53" class="spark" stroke="#ff4757" /> 
        <circle cx="100" cy="45" r="2" class="spark" fill="#1dd1a1" /> 
        <line x1="100" y1="45" x2="110" y2="40" class="spark" stroke="#feca57" /> 
        <line x1="100" y1="45" x2="90" y2="50" class="spark" stroke="#5f27cd" /> 
        <circle cx="100" cy="45" r="2.5" class="spark" fill="#ff9f43" /> 
        <line x1="100" y1="45" x2="100" y2="55" class="spark" stroke="#ee5253" /> 
        <line x1="100" y1="45" x2="110" y2="45" class="spark" stroke="#0abde3" /> 
        <circle cx="100" cy="45" r="1.5" class="spark" fill="#10ac84" /> 
        <line x1="100" y1="45" x2="105" y2="35" class="spark" stroke="#ff6b81" /> 
        <line x1="100" y1="45" x2="90" y2="35" class="spark" stroke="#feca57" /> 
      </g>
    </g>
  </g>
</svg>
